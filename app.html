<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sentinel | Autonomous AI SRE</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM (Pinned Versions) -->
    <script
      crossorigin
      src="https://unpkg.com/react@18.2.0/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"
    ></script>

    <!-- Prop-Types (Required dependency for Recharts UMD) -->
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>

    <!-- Recharts (Pinned Version known to work with React 18 UMD) -->
    <script src="https://unpkg.com/recharts@2.12.0/umd/Recharts.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Marked (for Markdown rendering) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;800&display=swap");
      body {
        font-family: "Inter", sans-serif;
        background-color: #0b1120; /* Darker slate */
        color: #e2e8f0;
        background-image: radial-gradient(
          circle at 50% 0%,
          #1e293b 0%,
          #0f172a 50%,
          #020617 100%
        );
        min-height: 100vh;
      }
      .mono {
        font-family: "JetBrains Mono", monospace;
      }
      .glass {
        background: rgba(30, 41, 59, 0.4);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(148, 163, 184, 0.1);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }
      .animate-pulse-slow {
        animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #334155;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #475569;
      }

      /* Markdown Styles */
      .prose {
        font-size: 0.95rem;
        line-height: 1.6;
        color: #cbd5e1;
      }
      .prose strong {
        color: #f1f5f9;
        font-weight: 600;
      }
      .prose h1,
      .prose h2,
      .prose h3 {
        color: #f8fafc;
        font-weight: 700;
        margin-top: 1em;
        margin-bottom: 0.5em;
      }
      .prose ul {
        list-style-type: disc;
        padding-left: 1.5em;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
      }
      .prose ol {
        list-style-type: decimal;
        padding-left: 1.5em;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
      }
      .prose code {
        background-color: rgba(15, 23, 42, 0.5);
        padding: 0.1em 0.3em;
        border-radius: 0.2em;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.85em;
        color: #e2e8f0;
      }
      .prose pre {
        background-color: rgba(15, 23, 42, 0.5);
        padding: 0.75em;
        border-radius: 0.5em;
        overflow-x: auto;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
        border: 1px solid rgba(51, 65, 85, 0.5);
      }
      .prose pre code {
        background-color: transparent;
        padding: 0;
        border: none;
        color: #e2e8f0;
        font-size: 0.85em;
      }
      .prose p {
        margin-bottom: 0.5em;
      }
      .prose blockquote {
        border-left: 3px solid #3b82f6;
        padding-left: 1em;
        margin-left: 0;
        color: #94a3b8;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      // Access Recharts from window object safely
      const {
        LineChart,
        Line,
        XAxis,
        YAxis,
        Tooltip,
        ResponsiveContainer,
        CartesianGrid,
        AreaChart,
        Area,
      } = window.Recharts || {};

      // --- Inline Icons to prevent external dependency failures ---
      const Icon = ({ path, size = 24, className = "" }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width={size}
          height={size}
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          {path}
        </svg>
      );

      const Icons = {
        Activity: (props) => (
          <Icon
            {...props}
            path={<polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />}
          />
        ),
        ShieldAlert: (props) => (
          <Icon
            {...props}
            path={
              <>
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" />
                <path d="M12 8v4" />
                <path d="M12 16h.01" />
              </>
            }
          />
        ),
        Cpu: (props) => (
          <Icon
            {...props}
            path={
              <>
                <rect x="4" y="4" width="16" height="16" rx="2" />
                <rect x="9" y="9" width="6" height="6" />
                <path d="M15 2v2" />
                <path d="M15 20v2" />
                <path d="M2 15h2" />
                <path d="M2 9h2" />
                <path d="M20 15h2" />
                <path d="M20 9h2" />
                <path d="M9 2v2" />
                <path d="M9 20v2" />
              </>
            }
          />
        ),
        Database: (props) => (
          <Icon
            {...props}
            path={
              <>
                <ellipse cx="12" cy="5" rx="9" ry="3" />
                <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" />
                <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" />
              </>
            }
          />
        ),
        Terminal: (props) => (
          <Icon
            {...props}
            path={
              <>
                <polyline points="4 17 10 11 4 5" />
                <line x1="12" x2="20" y1="19" y2="19" />
              </>
            }
          />
        ),
        CheckCircle2: (props) => (
          <Icon
            {...props}
            path={
              <>
                <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z" />
                <path d="m9 12 2 2 4-4" />
              </>
            }
          />
        ),
        AlertTriangle: (props) => (
          <Icon
            {...props}
            path={
              <>
                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" />
                <path d="M12 9v4" />
                <path d="M12 17h.01" />
              </>
            }
          />
        ),
        Play: (props) => (
          <Icon {...props} path={<polygon points="5 3 19 12 5 21 5 3" />} />
        ),
        Server: (props) => (
          <Icon
            {...props}
            path={
              <>
                <rect width="20" height="8" x="2" y="2" rx="2" ry="2" />
                <rect width="20" height="8" x="2" y="14" rx="2" ry="2" />
                <line x1="6" x2="6.01" y1="6" y2="6" />
                <line x1="6" x2="6.01" y1="18" y2="18" />
              </>
            }
          />
        ),
        Zap: (props) => (
          <Icon
            {...props}
            path={<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />}
          />
        ),
        LayoutDashboard: (props) => (
          <Icon
            {...props}
            path={
              <>
                <rect width="7" height="9" x="3" y="3" rx="1" />
                <rect width="7" height="5" x="14" y="3" rx="1" />
                <rect width="7" height="9" x="14" y="12" rx="1" />
                <rect width="7" height="5" x="3" y="16" rx="1" />
              </>
            }
          />
        ),
        FileText: (props) => (
          <Icon
            {...props}
            path={
              <>
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" x2="8" y1="13" y2="13" />
                <line x1="16" x2="8" y1="17" y2="17" />
                <line x1="10" x2="8" y1="9" y2="9" />
              </>
            }
          />
        ),
      };

      const {
        Activity,
        ShieldAlert,
        Cpu,
        Database,
        Terminal,
        CheckCircle2,
        AlertTriangle,
        Play,
        Server,
        Zap,
        LayoutDashboard,
        FileText,
      } = Icons;

      const generateInitialData = () => {
        const data = [];
        for (let i = 0; i < 20; i++) {
          data.push({
            time: i,
            cpu: 20 + Math.random() * 10,
            ram: 30 + Math.random() * 5,
          });
        }
        return data;
      };

      const MarkdownRenderer = ({ content }) => {
        const renderedHTML = React.useMemo(() => {
          return { __html: marked.parse(content) };
        }, [content]);

        return <div className="prose" dangerouslySetInnerHTML={renderedHTML} />;
      };

      const App = () => {
        const [logs, setLogs] = useState([]);
        const [metrics, setMetrics] = useState(generateInitialData());
        const [status, setStatus] = useState("MONITORING");
        const [activeAgent, setActiveAgent] = useState(null);
        const [isConnected, setIsConnected] = useState(false);
        const [activeTab, setActiveTab] = useState("dashboard"); // 'dashboard' | 'investigation'
        const [unreadLogs, setUnreadLogs] = useState(0);

        const ws = useRef(null);
        const logsEndRef = useRef(null);

        // --- WebSocket Connection ---
        useEffect(() => {
          const connect = () => {
            ws.current = new WebSocket(
              "wss://manish182-sentinel-ai-backend.hf.space/ws/ops"
            );

            ws.current.onopen = () => {
              console.log("WS Connected");
              setIsConnected(true);
            };

            ws.current.onclose = () => {
              console.log("WS Disconnected");
              setIsConnected(false);
            };

            ws.current.onmessage = (event) => {
              const data = JSON.parse(event.data);
              if (data.type === "agent_update") {
                addLog(data.agent, data.message);
                setActiveAgent(data.agent);
              } else if (data.type === "metrics_update") {
                updateMetrics(data.data.cpu, data.data.ram);
              } else if (data.type === "system_status") {
                setStatus(data.status.toUpperCase());
                if (data.status === "Resolved") setActiveAgent(null);
              }
            };
          };

          connect();
          return () => ws.current?.close();
        }, []);

        // Scroll to bottom of logs when new logs added, but only if on investigation page
        useEffect(() => {
          if (activeTab === "investigation") {
            logsEndRef.current?.scrollIntoView({ behavior: "smooth" });
          }
        }, [logs, activeTab]);

        const addLog = (agent, message) => {
          // Strip redundant [AgentName] prefix if present
          const cleanMessage = message.replace(
            new RegExp(`^\\[${agent}\\]\\s*`, "i"),
            ""
          );

          setLogs((prev) => [
            ...prev,
            {
              id: Date.now(),
              agent,
              message: cleanMessage,
              timestamp: new Date().toLocaleTimeString(),
            },
          ]);

          setUnreadLogs((prev) => prev + 1);
        };

        // Reset unread count when switching to investigation tab
        useEffect(() => {
          if (activeTab === "investigation") {
            setUnreadLogs(0);
          }
        }, [activeTab]);

        const updateMetrics = (cpu, ram) => {
          setMetrics((prev) => {
            const newTime = prev[prev.length - 1].time + 1;
            const newData = [...prev.slice(1), { time: newTime, cpu, ram }];
            return newData;
          });
        };

        const triggerSimulation = async (type) => {
          setStatus("INCIDENT DETECTED");
          setLogs([]);
          setUnreadLogs(0);

          try {
            await fetch(
              "https://manish182-sentinel-ai-backend.hf.space/api/trigger-simulation",
              {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ scenario_type: type }),
              }
            );
          } catch (e) {
            console.warn("Backend not found, running UI simulation mode");
            runFrontendSimulation(type);
          }
        };

        const runFrontendSimulation = (type) => {
          const isAnomaly = type !== "healthy";

          if (isAnomaly) {
            let steps = 0;
            const interval = setInterval(() => {
              steps++;
              updateMetrics(85 + Math.random() * 10, 60 + Math.random() * 5);
              if (steps > 20) clearInterval(interval);
            }, 500);
          }

          const sequence = [
            {
              agent: "Triage",
              msg: "**CRITICAL ANOMALY DETECTED**\nMetrics deviate from Isolation Forest baseline (Score: `0.82`). Anomaly detected on host `in24.inetnebr.com`.\n\n* CPU: 85% (High)\n* RAM: 92% (High)",
              delay: 800,
            },
            {
              agent: "Detective",
              msg: "Scanning `nasa_logs.csv`... Found **3 CRITICAL errors**.\n\n### Evidence Found:\n* Vector Search (ChromaDB) correlates with 'Database Saturation'.\n* Git scan reveals recent commit `a7f3d` (`config/database.yaml`).",
              delay: 2500,
            },
            {
              agent: "RCA Analyst",
              msg: "### Root Cause Identified\n\nDatabase Connection Saturation caused by misconfiguration in commit `a7f3d`. \n\n**Confidence:** 96%",
              delay: 5000,
            },
            {
              agent: "Architect",
              msg: "### Remediation Plan\n\n1.  **Revert** commit `a7f3d` immediately.\n2.  **Scale** Connection Pool (Writer Instance).\n3.  **Restart** API Pods.",
              delay: 7500,
            },
            {
              agent: "System",
              msg: "Remediation executed. System stabilizing.",
              delay: 9500,
            },
          ];

          sequence.forEach((step) => {
            setTimeout(() => {
              addLog(step.agent, step.msg);
              setActiveAgent(step.agent);
              if (step.agent === "System") {
                setStatus("RESOLVED");
                setActiveAgent(null);
              }
            }, step.delay);
          });
        };

        if (!window.Recharts) {
          return (
            <div className="min-h-screen flex items-center justify-center text-red-400 bg-slate-900">
              Error: Recharts library failed to load. Please check your internet
              connection.
            </div>
          );
        }

        return (
          <div className="min-h-screen p-4 md:p-6 flex flex-col gap-6 relative overflow-hidden">
            {/* Connection Status Badge */}
            <div className="absolute top-4 right-4 z-50">
              <span
                className={`px-2 py-1 rounded text-[10px] font-mono border backdrop-blur-md transition-colors duration-300 ${
                  isConnected
                    ? "bg-emerald-900/30 border-emerald-500/30 text-emerald-400"
                    : "bg-amber-900/30 border-amber-500/30 text-amber-400"
                }`}
              >
                {isConnected ? "● LIVE" : "○ SIMULATION"}
              </span>
            </div>

            {/* Header Area */}
            <header className="flex flex-col md:flex-row justify-between items-start md:items-center glass p-4 rounded-xl gap-4">
              <div className="flex items-center gap-4">
                <div className="bg-gradient-to-br from-blue-600 to-indigo-700 p-3 rounded-lg shadow-lg shadow-blue-500/20">
                  <ShieldAlert size={28} className="text-white" />
                </div>
                <div>
                  <h1 className="text-2xl font-bold tracking-tight text-white">
                    SENTINEL{" "}
                    <span className="text-blue-400 font-light">AI</span>
                  </h1>
                  <p className="text-xs text-slate-400 tracking-wide uppercase">
                    Autonomous SRE Platform
                  </p>
                </div>
              </div>

              {/* Navigation Tabs */}
              <div className="flex bg-slate-900/50 p-1 rounded-lg border border-slate-700/50 self-stretch md:self-auto">
                <button
                  onClick={() => setActiveTab("dashboard")}
                  className={`flex-1 md:flex-none flex items-center gap-2 px-6 py-2 rounded-md text-sm font-medium transition-all duration-200 ${
                    activeTab === "dashboard"
                      ? "bg-slate-700 text-white shadow-sm"
                      : "text-slate-400 hover:text-white hover:bg-slate-800/50"
                  }`}
                >
                  <LayoutDashboard size={16} />
                  Monitor
                </button>
                <button
                  onClick={() => setActiveTab("investigation")}
                  className={`relative flex-1 md:flex-none flex items-center gap-2 px-6 py-2 rounded-md text-sm font-medium transition-all duration-200 ${
                    activeTab === "investigation"
                      ? "bg-slate-700 text-white shadow-sm"
                      : "text-slate-400 hover:text-white hover:bg-slate-800/50"
                  }`}
                >
                  <FileText size={16} />
                  Investigation
                  {unreadLogs > 0 && activeTab !== "investigation" && (
                    <span className="absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] text-white font-bold animate-pulse">
                      {unreadLogs > 9 ? "9+" : unreadLogs}
                    </span>
                  )}
                </button>
              </div>

              <div className="hidden md:flex items-center gap-4 pl-4 border-l border-slate-700/50">
                <div className="text-right">
                  <p className="text-[10px] uppercase tracking-wider text-slate-500 font-bold">
                    Status
                  </p>
                  <div
                    className={`text-sm font-bold flex items-center justify-end gap-2 ${
                      status === "MONITORING"
                        ? "text-emerald-400"
                        : status === "RESOLVED"
                        ? "text-blue-400"
                        : "text-red-400 animate-pulse"
                    }`}
                  >
                    {status === "INCIDENT DETECTED" && (
                      <AlertTriangle size={14} />
                    )}
                    {status}
                  </div>
                </div>
              </div>
            </header>

            <main className="flex-1 min-h-0 relative">
              {/* DASHBOARD VIEW */}
              <div
                className={`transition-opacity duration-300 absolute inset-0 flex flex-col gap-6 ${
                  activeTab === "dashboard"
                    ? "opacity-100 z-10"
                    : "opacity-0 z-0 pointer-events-none"
                }`}
              >
                {/* Chart Section */}
                <div className="glass p-6 rounded-xl flex-1 flex flex-col min-h-0 relative overflow-hidden shadow-xl">
                  <div className="flex justify-between items-center mb-6">
                    <div className="flex items-center gap-2">
                      <div className="p-1.5 rounded bg-blue-500/10">
                        <Activity size={18} className="text-blue-400" />
                      </div>
                      <h3 className="text-lg font-semibold text-slate-200">
                        Infrastructure Telemetry
                      </h3>
                    </div>
                    <div className="flex gap-4 text-xs font-mono">
                      <div className="flex items-center gap-1.5">
                        <span className="w-2 h-2 rounded-full bg-red-500"></span>{" "}
                        CPU Usage
                      </div>
                      <div className="flex items-center gap-1.5">
                        <span className="w-2 h-2 rounded-full bg-blue-500"></span>{" "}
                        RAM Usage
                      </div>
                    </div>
                  </div>

                  <div className="flex-1 w-full min-h-0">
                    <ResponsiveContainer width="100%" height="100%">
                      <AreaChart data={metrics}>
                        <defs>
                          <linearGradient
                            id="colorCpu"
                            x1="0"
                            y1="0"
                            x2="0"
                            y2="1"
                          >
                            <stop
                              offset="5%"
                              stopColor="#ef4444"
                              stopOpacity={0.3}
                            />
                            <stop
                              offset="95%"
                              stopColor="#ef4444"
                              stopOpacity={0}
                            />
                          </linearGradient>
                          <linearGradient
                            id="colorRam"
                            x1="0"
                            y1="0"
                            x2="0"
                            y2="1"
                          >
                            <stop
                              offset="5%"
                              stopColor="#3b82f6"
                              stopOpacity={0.3}
                            />
                            <stop
                              offset="95%"
                              stopColor="#3b82f6"
                              stopOpacity={0}
                            />
                          </linearGradient>
                        </defs>
                        <CartesianGrid
                          strokeDasharray="3 3"
                          stroke="#334155"
                          vertical={false}
                          opacity={0.4}
                        />
                        <XAxis dataKey="time" hide />
                        <YAxis domain={[0, 100]} hide />
                        <Tooltip
                          contentStyle={{
                            backgroundColor: "#0f172a",
                            borderColor: "#334155",
                            color: "#f1f5f9",
                            borderRadius: "8px",
                            boxShadow: "0 4px 6px -1px rgba(0, 0, 0, 0.5)",
                          }}
                          itemStyle={{
                            fontSize: "12px",
                            fontFamily: "JetBrains Mono",
                          }}
                          labelStyle={{ display: "none" }}
                        />
                        <Area
                          type="monotone"
                          dataKey="cpu"
                          stroke="#ef4444"
                          strokeWidth={3}
                          fillOpacity={1}
                          fill="url(#colorCpu)"
                          isAnimationActive={true}
                        />
                        <Area
                          type="monotone"
                          dataKey="ram"
                          stroke="#3b82f6"
                          strokeWidth={3}
                          fillOpacity={1}
                          fill="url(#colorRam)"
                          isAnimationActive={true}
                        />
                      </AreaChart>
                    </ResponsiveContainer>
                  </div>
                </div>

                {/* Simulation Controls - Bottom Bar */}
                <div className="glass p-6 rounded-xl shadow-lg">
                  <div className="flex items-center gap-3 mb-4">
                    <Terminal size={18} className="text-purple-400" />
                    <h3 className="text-sm font-bold text-slate-300 uppercase tracking-wide">
                      Chaos Engineering Controls
                    </h3>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button
                      onClick={() => triggerSimulation("memory_leak")}
                      disabled={status === "INCIDENT DETECTED"}
                      className="group relative p-4 rounded-lg border border-red-500/20 bg-red-500/5 hover:bg-red-500/10 active:bg-red-500/20 transition-all text-left disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      <div className="flex items-center justify-between mb-2">
                        <Database
                          size={24}
                          className="text-red-400 group-hover:scale-110 transition-transform"
                        />
                        <div className="w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center">
                          <Zap size={14} className="text-red-400" />
                        </div>
                      </div>
                      <p className="font-bold text-base text-red-200">
                        Memory Leak
                      </p>
                      <p className="text-xs text-red-400/60 mt-1 font-mono">
                        Simulate OOM Exception
                      </p>
                    </button>

                    <button
                      onClick={() => triggerSimulation("db_crash")}
                      disabled={status === "INCIDENT DETECTED"}
                      className="group relative p-4 rounded-lg border border-orange-500/20 bg-orange-500/5 hover:bg-orange-500/10 active:bg-orange-500/20 transition-all text-left disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      <div className="flex items-center justify-between mb-2">
                        <Server
                          size={24}
                          className="text-orange-400 group-hover:scale-110 transition-transform"
                        />
                        <div className="w-8 h-8 rounded-full bg-orange-500/10 flex items-center justify-center">
                          <Zap size={14} className="text-orange-400" />
                        </div>
                      </div>
                      <p className="font-bold text-base text-orange-200">
                        DB Saturation
                      </p>
                      <p className="text-xs text-orange-400/60 mt-1 font-mono">
                        Trigger 502/Timeout
                      </p>
                    </button>

                    <button
                      onClick={() => triggerSimulation("healthy")}
                      className="group relative p-4 rounded-lg border border-emerald-500/20 bg-emerald-500/5 hover:bg-emerald-500/10 active:bg-emerald-500/20 transition-all text-left"
                    >
                      <div className="flex items-center justify-between mb-2">
                        <CheckCircle2
                          size={24}
                          className="text-emerald-400 group-hover:scale-110 transition-transform"
                        />
                        <div className="w-8 h-8 rounded-full bg-emerald-500/10 flex items-center justify-center">
                          <Play size={14} className="text-emerald-400 ml-0.5" />
                        </div>
                      </div>
                      <p className="font-bold text-base text-emerald-200">
                        System Healthy
                      </p>
                      <p className="text-xs text-emerald-400/60 mt-1 font-mono">
                        Restore Baseline
                      </p>
                    </button>
                  </div>
                </div>
              </div>

              {/* INVESTIGATION VIEW */}
              <div
                className={`transition-opacity duration-300 absolute inset-0 flex flex-col ${
                  activeTab === "investigation"
                    ? "opacity-100 z-10"
                    : "opacity-0 z-0 pointer-events-none"
                }`}
              >
                <div className="glass rounded-xl flex flex-col flex-1 overflow-hidden shadow-2xl">
                  {/* Status Bar for Logs */}
                  <div className="p-4 bg-slate-900/40 border-b border-slate-700/50 flex justify-between items-center backdrop-blur-md z-10">
                    <div className="flex items-center gap-3">
                      <div className="p-1.5 rounded bg-purple-500/10">
                        <Cpu size={18} className="text-purple-400" />
                      </div>
                      <div>
                        <h3 className="text-sm font-bold text-slate-200">
                          Sentinel Neural Engine
                        </h3>
                        <p className="text-[10px] text-slate-500 uppercase tracking-widest">
                          Multi-Agent Chain of Thought
                        </p>
                      </div>
                    </div>
                    {activeAgent && (
                      <div className="flex items-center gap-2 px-3 py-1.5 bg-emerald-500/10 border border-emerald-500/20 rounded-full">
                        <span className="relative flex h-2 w-2">
                          <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                          <span className="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                        </span>
                        <span className="text-xs font-bold text-emerald-300 tracking-wide uppercase">
                          {activeAgent} Processing...
                        </span>
                      </div>
                    )}
                  </div>

                  {/* Logs Container */}
                  <div className="flex-1 overflow-y-auto p-6 space-y-6 bg-slate-900/30">
                    {logs.length === 0 && (
                      <div className="h-full flex flex-col items-center justify-center text-slate-600 gap-4">
                        <div className="p-4 rounded-full bg-slate-800/50">
                          <Terminal size={32} className="opacity-50" />
                        </div>
                        <p className="font-mono text-sm">
                          Waiting for incident trigger...
                        </p>
                      </div>
                    )}

                    {logs.map((log) => (
                      <div
                        key={log.id}
                        className="group flex gap-4 animate-in fade-in slide-in-from-bottom-4 duration-500"
                      >
                        {/* Avatar / Line */}
                        <div className="flex flex-col items-center gap-2">
                          <div
                            className={`w-8 h-8 rounded-lg flex items-center justify-center shadow-lg border border-white/5 ${
                              log.agent === "Triage"
                                ? "bg-yellow-500/20 text-yellow-400"
                                : log.agent === "Detective"
                                ? "bg-blue-500/20 text-blue-400"
                                : log.agent === "RCA Analyst"
                                ? "bg-purple-500/20 text-purple-400"
                                : log.agent === "Architect"
                                ? "bg-emerald-500/20 text-emerald-400"
                                : "bg-slate-700 text-slate-400"
                            }`}
                          >
                            {log.agent === "Triage" && (
                              <AlertTriangle size={16} />
                            )}
                            {log.agent === "Detective" && (
                              <FileText size={16} />
                            )}
                            {log.agent === "RCA Analyst" && <Cpu size={16} />}
                            {log.agent === "Architect" && (
                              <Terminal size={16} />
                            )}
                            {log.agent === "System" && (
                              <CheckCircle2 size={16} />
                            )}
                          </div>
                          <div className="w-0.5 flex-1 bg-slate-800 group-last:bg-transparent" />
                        </div>

                        {/* Content Bubble */}
                        <div className="flex-1 pb-6 max-w-4xl">
                          <div className="flex items-center gap-2 mb-2">
                            <span
                              className={`text-xs font-bold uppercase tracking-wider ${
                                log.agent === "Triage"
                                  ? "text-yellow-400"
                                  : log.agent === "Detective"
                                  ? "text-blue-400"
                                  : log.agent === "RCA Analyst"
                                  ? "text-purple-400"
                                  : log.agent === "Architect"
                                  ? "text-emerald-400"
                                  : "text-slate-400"
                              }`}
                            >
                              {log.agent}
                            </span>
                            <span className="text-[10px] text-slate-600 font-mono">
                              {log.timestamp}
                            </span>
                          </div>

                          <div
                            className={`p-4 rounded-xl border ${
                              log.agent === "System"
                                ? "bg-green-900/10 border-green-500/20"
                                : "bg-slate-800/40 border-slate-700/50"
                            }`}
                          >
                            <MarkdownRenderer content={log.message} />
                          </div>
                        </div>
                      </div>
                    ))}
                    <div ref={logsEndRef} className="h-4" />
                  </div>
                </div>
              </div>
            </main>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
